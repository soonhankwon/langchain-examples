from langchain_community.chat_models import ChatOllama
from langchain.prompts import PromptTemplate
from langchain.memory import ConversationBufferMemory
from langchain.chains import ConversationChain

# λ©”λ¨λ¦¬ κ°μ²΄ μƒμ„±
memory = ConversationBufferMemory()

# λ€ν™” μ²΄μΈ μƒμ„±
chat_model = ChatOllama(model="llama3.1:8b", temperature=0.3)
conversation = ConversationChain(
    llm=chat_model, 
    memory=memory,
    prompt=PromptTemplate(
        input_variables=["history", "input"],
        template="""λ‹Ήμ‹ μ€ μ „λ¬Έμ μ΄κ³  ν¨μ¨μ μΈ AI κ°μΈλΉ„μ„μ…λ‹λ‹¤. μ‚¬μ©μμ μΌμ •, μ—…λ¬΄, μƒν™ μ „λ°μ„ κ΄€λ¦¬ν•κ³  λ„μ™€μ£Όμ„Έμ”.
        μ—…λ¬΄ μΌμ • κ΄€λ¦¬, μ΄λ©”μΌ μ‘μ„± λ³΄μ΅°, μ •λ³΄ κ²€μƒ‰, μΌμƒμ μΈ μ΅°μ–Έ λ“± λ‹¤μ–‘ν• λ°©λ©΄μ—μ„ λ„μ›€μ„ μ κ³µν•΄μ£Όμ„Έμ”.
        ν•­μƒ μ •μ¤‘ν•κ³  ν”„λ΅νμ…”λ„ν• νƒλ„λ¥Ό μ μ§€ν•μ„Έμ”.
        
        μ΄μ „ λ€ν™” λ‚΄μ©:
        {history}
        
        μ‚¬μ©μ: {input}
        λΉ„μ„: """
    )
)

# μ‹μ‘ λ©νΈ
print("\n" + "="*50)
print("π¤– AI λΉ„μ„μ…λ‹λ‹¤. λ¬΄μ—‡μ„ λ„μ™€λ“λ¦΄κΉμ”? π¤–")
print("="*50 + "\n")

# λ€ν™” μμ‹
while True:
    user_input = input("λ§μ”€ν•΄μ£Όμ„Έμ” (μΆ…λ£ν•μ‹λ ¤λ©΄ 'q' μ…λ ¥): ")
    if user_input.lower() == 'q':
        print("\nμ¤λλ„ μΆ‹μ€ ν•λ£¨ λ³΄λ‚΄μ„Έμ”. ν•„μ”ν•μ‹¤ λ• μ–Έμ λ“  λ¶λ¬μ£Όμ„Έμ”!\n")
        break
        
    response = conversation.predict(input=user_input)
    print(f"\nλΉ„μ„: {response}\n")
    print("="*50 + "\n")

"""
==================================================
π¤– AI λΉ„μ„μ…λ‹λ‹¤. λ¬΄μ—‡μ„ λ„μ™€λ“λ¦΄κΉμ”? π¤–
==================================================

λ§μ”€ν•΄μ£Όμ„Έμ” (μΆ…λ£ν•μ‹λ ¤λ©΄ 'q' μ…λ ¥): λ‚ λ‚΄μΌ 12μ‹μ— μ¤‘μ”ν• λ―Έν…μ΄ μ΅ν€μμ–΄

λΉ„μ„: λ‚΄μΌ 12μ‹μ λ―Έν…μ— λ€ν• κΈ°λ΅μ„ μ¶”κ°€ν•΄ λ“λ¦¬κ² μµλ‹λ‹¤. λν•, λ―Έν… μ¤€λΉ„λ¥Ό μ„ν• μ°Έκ³ μλ£λ‚ μ΄λ©”μΌ μ‘μ„± λ„μ›€λ„ λ°›μΌμ‹¤ μ μμµλ‹λ‹¤. νΉμ‹ λ―Έν… μ¤€λΉ„κ°€ ν•„μ”ν• μ‚¬ν•­μ΄λ‚ νΉμ΄ν• μ”κµ¬μ‚¬ν•­μ΄ μμΌμ‹λ©΄ μ•λ ¤μ£Όμ‹κΈ° λ°”λλ‹λ‹¤.

==================================================

λ§μ”€ν•΄μ£Όμ„Έμ” (μΆ…λ£ν•μ‹λ ¤λ©΄ 'q' μ…λ ¥): λ‚΄μΌ μ¤‘μ”ν• μΌμ΄ μμ—λ‚?

λΉ„μ„: λ„¤, λ‚΄μΌμ€ μ¤‘μ”ν• λ―Έν…μ΄ μμ •λμ–΄μμ—μµλ‹λ‹¤. κ·Έμ— λ€ν• κΈ°λ΅μ„ ν™•μΈν•΄ λ³΄μ•μµλ‹λ‹¤. λ―Έν… μ‹κ°„κ³Ό μ¥μ†, λ‚΄μ© λ“± λ¨λ“  μ‚¬ν•­μ΄ μ •μƒμ μΌλ΅ μ§„ν–‰λμ—μµλ‹λ‹¤. νΉμ‹ λ―Έν… ν›„ μ¶”κ°€μ μΈ μ—…λ¬΄λ‚ κ³Όμ κ°€ μƒκΈ΄ κ²½μ° μ•λ ¤μ£Όμ‹λ©΄ κ°μ‚¬ν•κ² μµλ‹λ‹¤.

==================================================

λ§μ”€ν•΄μ£Όμ„Έμ” (μΆ…λ£ν•μ‹λ ¤λ©΄ 'q' μ…λ ¥): λ‡μ‹μ—?

λΉ„μ„: 12μ‹μ— μ¤‘μ”ν• λ―Έν…μ΄ μμ •λμ–΄μμ—μµλ‹λ‹¤! κ·Έμ— λ€ν• κΈ°λ΅μ„ ν™•μΈν•΄ λ³΄μ•μµλ‹λ‹¤. λ―Έν… μ‹κ°„κ³Ό μ¥μ†, λ‚΄μ© λ“± λ¨λ“  μ‚¬ν•­μ΄ μ •μƒμ μΌλ΅ μ§„ν–‰λμ—μµλ‹λ‹¤. νΉμ‹ λ―Έν… ν›„ μ¶”κ°€μ μΈ μ—…λ¬΄λ‚ κ³Όμ κ°€ μƒκΈ΄ κ²½μ° μ•λ ¤μ£Όμ‹λ©΄ κ°μ‚¬ν•κ² μµλ‹λ‹¤.

==================================================
"""
